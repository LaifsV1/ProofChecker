\title{Proof Checker Notes}
\author{Yu-Yang Lin}
\date{\today}

\documentclass[twoside,a4paper]{article}

\usepackage{mathtools}
\usepackage{syntax}
\usepackage{bussproofs}
\usepackage{boxproof}
\usepackage[margin=2cm]{geometry}
\usepackage{changepage}

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\setlength{\parskip}{1em}
\setlength\parindent{0pt}

% Palatino for rm and math | Helvetica for ss | Courier for tt
\usepackage{mathpazo} % math & rm
\linespread{1.05} % Palatino needs more leading (space between lines)
\usepackage[scaled]{helvet} % ss
\usepackage{courier} % tt
\normalfont
\usepackage[T1]{fontenc}


\begin{document}
\maketitle

\section{Syntax Grammar}
\begin{center}
\begin{tabular}{rll}
(types)& $\tau$ ::= bool 
| $\tau$ $\rightarrow$ $\tau $ | nat | list $\tau$
\\
(hypotheses)& A , B ::= $\top$ | $\bot$
| A $\wedge$ B | A $\vee$ B | A $\supset$ B 
| $\forall$ $x$ : $\tau$ . A | $\exists$ $x$ : $\tau$ . A
| t = t : $\tau$
\\
(terms)& e , t ::= $x$ | t t | true | false 
| [ ] | t :: t  %lists
| zero | suc( t ) %natural numbers
\\
(term context)& $\psi$ ::= . | $\psi$, $x$ : $\tau$
\end{tabular}

\begin{tabular}{rll}
$\psi$ &$\vdash$ & t : $\tau$\\
$\psi$ &$\vdash$ & A prop
\end{tabular}
\end{center}

\section{Specification rules of terms typing and hypotheses}

\subsection{Terms}
Natural Numbers:
\[
\AxiomC{}
\RightLabel{\quad (nat-zero)}
\UnaryInfC{$\psi \vdash$ zero : nat}
\DisplayProof
\qquad
\qquad
\AxiomC{$\psi \vdash$ t : nat}
\RightLabel{\quad (nat-suc-n)}
\UnaryInfC{$\psi \vdash$ suc( t ) : nat}
\DisplayProof
\]

Booleans:
\[
\AxiomC{}
\RightLabel{\quad (bool-true)}
\UnaryInfC{$\psi \vdash$ true : bool}
\DisplayProof
\qquad
\qquad
\AxiomC{}
\RightLabel{\quad (bool-false)}
\UnaryInfC{$\psi \vdash$ false : bool}
\DisplayProof
\]

Lists:
\[
\AxiomC{}
\RightLabel{\quad (list-empty)}
\UnaryInfC{$\psi \vdash$ [ ] : list t}
\DisplayProof
\qquad
\qquad
\AxiomC{$\psi \vdash$ t' : t}
\AxiomC{$\psi \vdash$ t'' : list t}
\RightLabel{\quad (list-hd::tl)}
\BinaryInfC{$\psi \vdash$ t' :: t'' : list t}
\DisplayProof
\]

Variables:
\[
\AxiomC{$x : \tau \in \psi$}
\RightLabel{\quad (var)}
\UnaryInfC{$\psi \vdash x : \tau$}
\DisplayProof
\]

Application:
\[
\AxiomC{$\psi \vdash$ t : $\tau \rightarrow \tau$'}
\AxiomC{$\psi \vdash$ t' : $\tau$}
\RightLabel{\quad (app)}
\BinaryInfC{$\psi \vdash$ t t' : $\tau$'}
\DisplayProof
\]

\subsection{Propositions}
Truth and Falsity Propositions:
\[
\AxiomC{}
\RightLabel{\quad ($\top$-prop)}
\UnaryInfC{$\psi \vdash$ $\top$  prop}
\DisplayProof
\qquad
\qquad
\AxiomC{}
\RightLabel{\quad ($\bot$-prop)}
\UnaryInfC{$\psi \vdash$ $\bot$  prop}
\DisplayProof
\]

Binary Relation Propositions:
\[
\AxiomC{$\psi \vdash$ A prop}
\AxiomC{$\psi \vdash$ B prop}
\RightLabel{\quad ($\wedge$-prop)}
\BinaryInfC{$\psi \vdash$ A $\wedge$ B prop}
\DisplayProof
\]

\[
\AxiomC{$\psi \vdash$ A prop}
\AxiomC{$\psi \vdash$ B prop}
\RightLabel{\quad ($\vee$-prop)}
\BinaryInfC{$\psi \vdash$ A $\vee$ B prop}
\DisplayProof
\]

\[
\AxiomC{$\psi \vdash$ A prop}
\AxiomC{$\psi \vdash$ B prop}
\RightLabel{\quad ($\supset$-prop)}
\BinaryInfC{$\psi \vdash$ A $\supset$ B prop}
\DisplayProof
\]

\[
\AxiomC{$\psi \vdash $t$ : \tau$}
\AxiomC{$\psi \vdash $t'$ : \tau$}
\RightLabel{\quad (eq-prop)}
\BinaryInfC{$\psi \vdash$ (t = t' : $\tau$) prop}
\DisplayProof
\]

Quantifier Propositions:
\[
\AxiomC{$\psi , x : \tau \vdash$ A prop}
\RightLabel{\quad ($\forall$-prop)}
\UnaryInfC{$\psi \vdash \forall x : \tau .$ A prop}
\DisplayProof
\]

\[
\AxiomC{$\psi , x : \tau \vdash$ A prop}
\RightLabel{\quad ($\exists$-prop)}
\UnaryInfC{$\psi \vdash \exists x : \tau .$ A prop}
\DisplayProof
\]

\section{Implementation rules for type inference and checking}

\subsection{Syntax grammar}
\begin{center}
\begin{tabular}{rll}
(infer)& e ::= x 
| e v | true | false | zero | suc( e )
\\
(check)& v ::= v :: v  | nil | e
\end{tabular}
\end{center}

Type Inferece Rule:
\[\overset{-}\psi \vdash \overset{-}{t} \Rightarrow \overset{+}\tau\]

Type Checking Rule:
\[\overset{-}\psi \vdash \overset{-}{t} \Leftarrow \overset{-}\tau\]

\subsection{Term type inference}
Variables:
\[
\AxiomC{$x : \tau \in \psi$}
\RightLabel{\quad (var)}
\UnaryInfC{$\psi \vdash x \Rightarrow \tau$}
\DisplayProof
\]

Application:
\[
\AxiomC{$\psi \vdash$ t $\Rightarrow$ $\tau \rightarrow \tau$'}
\AxiomC{$\psi \vdash$ t' $\Leftarrow$ $\tau$}
\RightLabel{\quad (app)}
\BinaryInfC{$\psi \vdash$ t t' $\Rightarrow$ $\tau$'}
\DisplayProof
\]

Natural Numbers:
\[
\AxiomC{}
\RightLabel{\quad (nat-zero)}
\UnaryInfC{$\psi \vdash$ zero $\Rightarrow$ nat}
\DisplayProof
\qquad
\qquad
\AxiomC{$\psi \vdash$ t $\Leftarrow$ nat}
\RightLabel{\quad (nat-suc-n)}
\UnaryInfC{$\psi \vdash$ suc( t ) $\Rightarrow$ nat}
\DisplayProof
\]

Booleans:
\[
\AxiomC{}
\RightLabel{\quad (bool-true)}
\UnaryInfC{$\psi \vdash$ true $\Rightarrow$ bool}
\DisplayProof
\qquad
\qquad
\AxiomC{}
\RightLabel{\quad (bool-false)}
\UnaryInfC{$\psi \vdash$ false $\Rightarrow$ bool}
\DisplayProof
\]

\subsection{Term type checking}
Lists:
\[
\AxiomC{}
\RightLabel{\quad (list-empty)}
\UnaryInfC{$\psi \vdash$ [ ] $\Leftarrow$ list t}
\DisplayProof
\qquad
\qquad
\AxiomC{$\psi \vdash$ t' $\Leftarrow$ t}
\AxiomC{$\psi \vdash$ t'' $\Leftarrow$ list t}
\RightLabel{\quad (list-hd::tl)}
\BinaryInfC{$\psi \vdash$ t' :: t'' $\Leftarrow$ list t}
\DisplayProof
\]

Inference Case:
\[
\AxiomC{$\psi \vdash$ t $\Rightarrow \tau$'}
\AxiomC{$\tau = \tau'$}
\RightLabel{\quad (app)}
\BinaryInfC{$\psi \vdash$ t $\Leftarrow$ $\tau$}
\DisplayProof
\]

\subsection{Propositions type checking}
Truth and Falsity Propositions:
\[
\AxiomC{}
\RightLabel{\quad ($\top$-prop)}
\UnaryInfC{$\psi \vdash$ $\top$ prop}
\DisplayProof
\qquad
\qquad
\AxiomC{}
\RightLabel{\quad ($\bot$-prop)}
\UnaryInfC{$\psi \vdash$ $\bot$ prop}
\DisplayProof
\]

Binary Relation Propositions:
\[
\AxiomC{$\psi \vdash$ A prop}
\AxiomC{$\psi \vdash$ B prop}
\RightLabel{\quad ($\wedge$-prop)}
\BinaryInfC{$\psi \vdash$ A $\wedge$ B prop}
\DisplayProof
\]

\[
\AxiomC{$\psi \vdash$ A prop}
\AxiomC{$\psi \vdash$ B prop}
\RightLabel{\quad ($\vee$-prop)}
\BinaryInfC{$\psi \vdash$ A $\vee$ B prop}
\DisplayProof
\]

\[
\AxiomC{$\psi \vdash$ A prop}
\AxiomC{$\psi \vdash$ B prop}
\RightLabel{\quad ($\supset$-prop)}
\BinaryInfC{$\psi \vdash$ A $\supset$ B prop}
\DisplayProof
\]

\[
\AxiomC{$\psi \vdash $t$ \Leftarrow \tau$}
\AxiomC{$\psi \vdash $t'$ \Leftarrow \tau$}
\RightLabel{\quad (eq-prop)}
\BinaryInfC{$\psi \vdash$ (t = t' $\Leftarrow$ $\tau$) prop}
\DisplayProof
\]

Quantifier Propositions:
\[
\AxiomC{$\psi , x \Leftarrow \tau \vdash$ A prop}
\RightLabel{\quad ($\forall$-prop)}
\UnaryInfC{$\psi \vdash \forall x \Leftarrow \tau .$ A prop}
\DisplayProof
\]

\[
\AxiomC{$\psi , x \Leftarrow \tau \vdash$ A prop}
\RightLabel{\quad ($\exists$-prop)}
\UnaryInfC{$\psi \vdash \exists x \Leftarrow \tau .$ A prop}
\DisplayProof
\]

\subsection{Function signatures}
\begin{center}
\tt
\begin{tabular} {rl}
infer_term &: $\psi$ $\rightarrow$ t $\rightarrow$ $\tau$ option
\\
check_term &: $\psi$ $\rightarrow$ t $\rightarrow$ $\tau$ $\rightarrow$ unit option
\\
check_prop &: $\psi$ $\rightarrow$ A $\rightarrow$ unit option
\end{tabular}

\begin{tabular} {rll}

&val infer_term &: ctx -> term -> tp option
\\
&val check_term &: ctx -> term -> tp -> unit option
\\
&val check_prop &: ctx -> prop -> unit option

\end{tabular}
\end{center}


\section{Rules for well-formedness of proofs}
\subsection{Syntax grammar}
\begin{center}
\begin{tabular}{rrrl}
(proofs)& p , q &::=& by H 
\\ &&|& (p , q) 
\\ &&|& {\tt let} (H',H'') {\tt =} H {\tt in} p
\\ &&|& (p , q ) {\tt either} 
\\ &&|& {\tt match [}H{\tt  ] : (}A $\vee$ B{\tt ) with (}
\\ &&&\qquad \qquad | A {\tt [}H'{\tt ]:} p {\tt ->} C 
\\ &&&\qquad \qquad | B {\tt [}H''{\tt ]:} q {\tt ->} C {\tt)}
\\
(hypotheses context)& $\Gamma$ &::=& \quad $\cdot$ \quad 
\\ &&| & $\Gamma$ , H : A
\\ &&| & Assume A [ H ] , p
\end{tabular}

\begin{tabular} {rl}
$\psi ; \Gamma$ &$\vdash$ p : A
\\
$\psi $ & $\vdash \Gamma$
\end{tabular}
\end{center}

\subsection{Rules}
Truth and Falsity:
\[
\AxiomC{}
\RightLabel{\quad ($\top$R)}
\UnaryInfC{$\psi ; \Gamma \vdash$ $\top$ : C}
\DisplayProof
\qquad
\qquad
\AxiomC{}
\RightLabel{\quad ($\bot$L)}
\UnaryInfC{$\psi ; \Gamma ,$  H : $\bot$ 
$\vdash $
{\tt match} H {\tt with} $\bot$ : C
}
\DisplayProof
\]

Conjunction:
\[
\AxiomC{$\psi ; \Gamma ,$ H : A $\wedge$ B , H' : A , H'' : B 
$\vdash$ p : C}
\RightLabel{\quad ($\wedge$L)}
\UnaryInfC{$\psi ; \Gamma ,$ H : A $\wedge$ B $\vdash$
{\tt let (}H'{\tt,}H''{\tt) = }H {\tt  in }p}
\DisplayProof
\]

\[
\AxiomC{$\psi ; \Gamma \vdash$ p : A}
\AxiomC{$\psi ; \Gamma \vdash$ q : B}
\RightLabel{\quad ($\wedge$R)}
\BinaryInfC{$\psi ; \Gamma \vdash$ (p , q) : A $\wedge$ B}
\DisplayProof
\]

Disjunction:
\[
\AxiomC{$\psi ; \Gamma$ , H : A $ \vee$ B , H' : A $\vdash$ p : C}
\AxiomC{$\psi ; \Gamma$ , H : A $ \vee$ B , H'' : B $\vdash$ q : C}
\RightLabel{\quad ($\vee$L)}
\BinaryInfC{$\psi ; \Gamma ,$  H : A 
$ \vee$ B $\vdash $
 {\tt  match [}H{\tt] with(}
 A {\tt [}H'{\tt ]:} p
 | B {\tt [}H''{\tt ]:} q {\tt)} : C
}
\DisplayProof
\]

\[
\AxiomC{$\psi ; \Gamma \vdash$ p : A}
\RightLabel{\quad ($\vee R_1$)}
\UnaryInfC{$\psi ; \Gamma \vdash$ {\tt Left} p : A $\vee$ B}
\DisplayProof
\]

\[
\AxiomC{$\psi ; \Gamma \vdash$ q : B}
\RightLabel{\quad ($\vee R_2$)}
\UnaryInfC{$\psi ; \Gamma \vdash$ {\tt Right} q :  A $\vee$ B}
\DisplayProof
\]

Implication:
\[
\AxiomC{$\psi ; \Gamma ,$ H : A $\supset$ B $\vdash$ p : A}
\AxiomC{$\psi ; \Gamma ,$ H : A $\supset$ B , H' : B $\vdash$ q : C}
\RightLabel{\quad ($\supset$L)}
\BinaryInfC{$\psi ; \Gamma ,$ H : A $\supset$ B $\vdash$
(p, B [ H' ] via H, q) : C}
\DisplayProof
\]

\[
\AxiomC{$\psi ; \Gamma$ , H : A $\vdash$ p : B}
\RightLabel{\quad ($\supset$R)}
\UnaryInfC{$\psi ; \Gamma \vdash$ ( Assume A [ H ] , p ) : A 
$\supset$ B}
\DisplayProof
\]

Using hypotheses:

\[
\AxiomC{}
\RightLabel{\quad (by)}
\UnaryInfC{$\psi ; \Gamma , $ [ H ] : A $\vdash$ by H : A}
\DisplayProof
\]

\[
\AxiomC{$\psi ; \Gamma \vdash$ p : A}
\RightLabel{\quad (therefore)}
\UnaryInfC{$\psi ; \Gamma \vdash$ p Therefore A : A}
\DisplayProof
\]

\subsection{Function signature}
\begin{center}
{\tt
check_proof : $\psi \rightarrow \Gamma \rightarrow $ P 
$\rightarrow$ A $\rightarrow$ unit option
}
\end{center}



\end{document}

